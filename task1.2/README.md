# Задание 1.2. Вариант 1.  Интегрирование

Исходный код обычной и векторизированной программ можно найти в файлах [`main.cpp`](./main.cpp)
и [`main_opt.cpp`](./main_opt.cpp) соответственно.

Для подсчета значения определенного интеграла на отрезке используется простейший
метод прямоугольников.

В качестве интегрируемой функции я выбрал `f(x) = sqrt(x)`, потому что существует ее векторный аналог
`_mm256_sqrt_pd`. Программа считает интеграл `f(x)` на отрезке `[1, 5]` с разбиением на `10^9` отрезков
и выводит в стандартный поток вывода получившиеся значение. 

Также, применяется `_mm256_fmadd_pd(a, b, c)` для выполнения `a * b + c`, которая требует
поддержку `FMA` процессором (флаг компилятора `-mfma`).

## Сборка

> **NOTE**: `clang v12.0.1`

```sh
$ cmake -DCMAKE_CXX_COMPILER=clang++ -B build
$ cmake --build build
```

По итогам сборки у нас должно появиться 3 исполняемых файла в директории `./build/`:
* `hse_parallel_task1_2`: без оптимизаций
* `hse_parallel_task1_2_comp`: оптимизация только с помощью флагов компилятора (`-O3 -Ofast`)
* `hse_parallel_task1_2_opt`: оптимизация с помощью компилятора и векторизации операций

## Результаты

* Без оптимизации:
  ```sh
  $ time ./build/hse_parallel_task1_2
  6.78689
  ./build/hse_parallel_task1_2  39.96s user 0.00s system 99% cpu 40.036 total
  ```
* Оптимизация только с помощью флагов компилятора:
  ```sh
  $ time ./build/hse_parallel_task1_2_comp
  6.78689
  ./build/hse_parallel_task1_2_comp  3.97s user 0.00s system 99% cpu 3.984 total
  ```
* Оптимизация с помощью флагов компилятора и векторизации операций:
  ```sh
  $ time ./build/hse_parallel_task1_2_opt
  6.78689
  ./build/hse_parallel_task1_2_opt  1.36s user 0.00s system 99% cpu 1.363 total
  ```

Из приведенных результатов можно сделать вывод, что хоть сам компилятор действительно умеет
значительно увеличивать производительность (в 10 раз!) программ за счет встроенных средств,
но это не отменяет возможности для ручных оптимизаций с помощью векторизации: осле векторизации
быстродействие нашей программы увеличилось еще в 3 раза.

